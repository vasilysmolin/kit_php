version: '3'

services:

  php:
    build:
      context: images/php
      dockerfile: Dockerfile
      args:
        - ENV=${DOCKER_ENV}
        - USER=${USER}
        - UID=${UID}
    container_name: ${BB_PHP_WORKDIR}
    environment:
      PHP_IDE_CONFIG: "serverName=Docker"
    restart: always
    working_dir: /var/www/${BB_PHP_WORKDIR}
    volumes:
      - .:/var/www/${BB_PHP_WORKDIR}

  database:
    build:
      context: images/postgres
      dockerfile: Dockerfile
    container_name: database
    restart: always
    environment:
      POSTGRES_PASSWORD: secret
      POSTGRES_DB: laravel_docker
    volumes:
      - ./postgres-data:/var/lib/postgresql/data
    ports:
      - '5432:5432'
